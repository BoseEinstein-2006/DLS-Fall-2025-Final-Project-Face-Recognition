# DLS-Fall-2025-Final-Project-Face-Recognition

В этом репрезитории собраны ноутбуки, ссылки и прочеее, что я использовал для финального проекта по Face Recognition для DLS по курсу Deep Learning (семестр 1, весна 2025).

# Основные задания

## Шаг 0: предварительный анализ данных

**0_Data_analysis.ipynb**

В этом ноутбуке я сделал быстренький анализ данных, покрутил их туда-сюда. Этот ноутбук я использовал локально на своем компьютере.

Получилось достаточно сумбурно, но что есть.

**Inputs:** 

1) папка "archive" с изображениями и файлами "list_attr_celeba.csv", "list_bbox_celeba.csv", скаченными отсюда:

https://www.kaggle.com/datasets/kevinpatel04/celeba-original-wild-images

2) "list_landmarks_celeba.txt" и "identity_CelebA.txt", скачены отсюда:

https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html

**Outputs:** 

Ничего :)

**Выводы:**

1) Распределение картинок по аттрибутам выглядит разумным, типа Male около 50%, мало с очками и шляпами и прочее

2) Картинки с Blurry можно все выкинуть, их немного

3) Есть куча (>3k) identities c количеством изображений больше 25, так что есть из чего выбирать для обучения

4) Можно выкинуть картинки с слишком маленькими bbox

5) Сами bbox можно уменьшить на 5% процентов, чтобы захватить чисто лицо

## Шаг 1: подготовка данных для Stacked Hourglass

**1_Data_preparation.ipynb**

В этом ноутбуке я выбираю картинки на которых буду обучать Stacked Hourglass на следующем шаге. Этот ноутбук я использовал локально на своем компьютере.

**Inputs:** 

1) папка "archive" с изображениями и файлами "list_attr_celeba.csv", "list_bbox_celeba.csv", скаченными отсюда:

https://www.kaggle.com/datasets/kevinpatel04/celeba-original-wild-images

2) "list_landmarks_celeba.txt" и "identity_CelebA.txt", скачены отсюда:

https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html

**Outputs:**

1) папка selected images, где лежат отобранные картинки
2) "selected_images.csv" где записаны image_id, attrbiutes и прочее для отобранных картинок

Все это я положил на свой Google Drive здесь:


**Выводы:**

1) Избавляемся от всех картинок с Blurry == 1 и bbox меньше заданных минимальных размеров. Из оставшихся картинок будем выбирать данные для следущего Шага.
2) Для FaceRecognition важно чтобы на каждую identity было достаточно изображений, поэтому надо выбирать identity с достаточным количеством картинок. 
3) Я чуть поэкспериментировал и остановился на том, что надо 25 картинок на каждую identity. При этом было хорошо иметь много разных identities, например 1000.
4) Итого выбирает 1000 identities с 25 картинок на каждую identity = 25000 изображений для следущего Шага.
5) По хорошему надо бы сверху еще докинуть фильтров, что бы в конечной выборке было например 50% мужчин, 5% с очками, 5% с шапками и прочим. Я изначально так и делал, но потом я не заметил чтобы это как-то изменило метрики для выравливания или распознования. Так что в финальной версии я все это выкинул и выбирал 25000 картинок лишь по identites.
